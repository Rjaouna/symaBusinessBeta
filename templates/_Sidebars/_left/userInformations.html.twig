<div class="mt-4 mb-2 px-2 py-3 rounded shadow-sm bg-light border">
    <div class="d-flex align-items-center mb-3">
        <a href="{{ path('app_syma_business') }}">
            <img src="/assets/img/profil.png" alt="Photo de profil" 
                 class="rounded-circle border" 
                 style="width: 50px; height: 50px; object-fit: cover;">
        </a>
        <h6 class="ms-3 text-dark mx-2">
            Bonjour, <strong class="user-name">{{ app.user.nomResponsable }}</strong> !
        </h6>
    </div>
    <p class="mb-3 text-secondary">
        {% if app.user.quotas is not null %}
            {% if app.user.quotas.nom %}
                Votre quota actuel est de 
                <strong class="user-quota">{{ app.user.quotas.nom }}</strong>.
            {% else %}
                Aucun quota attribué.
            {% endif %}
        {% else %}
            Aucun quota attribué.
        {% endif %}
        <a class="text-decoration-none link-primary ms-2" href="#">
            Pourquoi le système de quotas ?
        </a>
    </p>
    <hr>
    <p class="mb-0">
        <i class="bi bi-wallet2 fs-4 me-2"></i>
        Vous avez un bonus de 
        <strong class="user-bonus">{{ app.user.totalBonus }} points</strong>.
        <a class="text-decoration-none link-primary ms-2" 
           href="{{path('app_user_Bonus_Controller')}}">
            Gérer mon bonus
        </a>
    </p>
</div>


<script>
async function fetchUserInformation() {
    try {
        const response = await axios.get("/api/user");
        // Store user data in localStorage
        localStorage.setItem('userData', JSON.stringify(response.data));
        displayUserInformation(); // Call to display the user information
    } catch (error) {
        console.error('Error fetching user information:', error);
    }
}

function displayUserInformation() {
    const userData = JSON.parse(localStorage.getItem('userData')); // Récupérez les données
    console.log(userData);

    if (userData) {
        document.querySelector('.user-name').textContent = userData.nomResponsable || 'Utilisateur';

        // Access the correct property for quotas
        const quotaName = userData.quotas ? userData.quotas.nom : 'inconnu';
        document.querySelector('.user-quota').textContent = quotaName;

        document.querySelector('.user-bonus').textContent = `${userData.totalBonus} points`;
    }
}

// Fetch user information when the script loads
fetchUserInformation();

// Set interval to fetch user information every 5 seconds (5000 milliseconds)
setInterval(fetchUserInformation, 3000);
</script>


