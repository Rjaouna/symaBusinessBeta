<div class="mt-4 mb-3 px-4 py-3 rounded shadow-sm bg-light border">
    <!-- Profile Section -->
    <div class="d-flex flex-column align-items-center mb-3">
        <a href="{{ path('app_syma_business') }}">
            <img src="/assets/img/profil.png" alt="Photo de profil" 
                 class="rounded-circle border" 
                 style="width: 80px; height: 80px; object-fit: cover;">
        </a>
        <h5 class="mt-2 text-dark text-center">
            <strong>{{ app.user.nomResponsable }}</strong>
        </h5>
        <h6 class="mb-0 text-secondary text-center" style="font-weight: 100; letter-spacing: -0.5px;">
            {{ app.user.email }}
        </h6>
    </div>
   

    <!-- Quota Information: Two Columns Layout -->
    <div class="row mb-3">
        <div class="col-md-6   p-2 d-flex flex-column justify-content-center shadow-sm">
            <p class="text-secondary mb-0"><strong>Quota actuel</strong></p>
            {% if app.user.quotas is not null %}
                <p class="user-quota">{{ app.user.quotas.nom }}</p>
            {% else %}
                <p>Aucun quota attribué.</p>
            {% endif %}
        </div>

        <!-- "En savoir plus" Column -->
        <div class="col-md-6 shadow-sm p-2 d-flex flex-column justify-content-center text-end">
            <a class="text-decoration-none link-primary" href="#">En savoir plus</a>
        </div>
        <!-- "En savoir plus" content -->

         <div id="contentDiffQuotaActuel" class="row mb-3 d-none pt-3">
    <div class="col-12">
        <p><strong>Le quota d'un point de vente</strong> se calcule chaque début de mois automatiquement par notre <strong>application de gestion</strong>.</p>
        <p>Le quota est déterminé en fonction du taux (%) de <strong>transformation en passe ou forfait des cartes SIM vendues et activées</strong> par chaque point de vente.</p>
        <p>Le <strong>taux moyen calculé</strong> se base sur les 3 derniers mois. Chaque début de mois, un <strong>email automatique</strong> préviendra chaque point de vente, lui notifiant son <strong>nouveau quota pour le mois</strong>.</p>
    </div>
</div>

        <!-- Bonus Information -->
        <div class="shadow-sm p-2  justify-content-center ">
    <p class="mb-0 text-dark">
        <i class="bi bi-wallet2 fs-4 me-2"></i>
        Vous avez un bonus de 
        <strong class="user-bonus text-success">{{ app.user.totalBonus }} points</strong>.
        <a class="text-decoration-none link-primary ms-2" 
           href="{{ path('app_user_Bonus_Controller') }}">
            Gérer mon bonus
        </a>
    </p>
    </div>
    </div>


    
</div>



<!-- JavaScript to Fetch and Display User Data -->
<script>
async function fetchUserInformation() {
    try {
        const response = await axios.get("/api/user");
        // Store user data in localStorage
        localStorage.setItem('userData', JSON.stringify(response.data));
        displayUserInformation(); // Call to display the user information
    } catch (error) {
        console.error('Error fetching user information:', error);
    }
}

function displayUserInformation() {
    const userData = JSON.parse(localStorage.getItem('userData')); // Retrieve user data
    console.log(userData);

    if (userData) {
        document.querySelector('.user-name').textContent = userData.nomResponsable || 'Utilisateur';

        // Access the correct property for quotas
        const quotaName = userData.quotas ? userData.quotas.nom : 'inconnu';
        document.querySelector('.user-quota').textContent = quotaName;

        document.querySelector('.user-bonus').textContent = `${userData.totalBonus} points`;
    }
}

// Fetch user information when the script loads
fetchUserInformation();

// Set interval to fetch user information every 5 seconds (5000 milliseconds)
setInterval(fetchUserInformation, 3000);
</script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Récupérer l'élément "En savoir plus"
        const enSavoirPlus = document.querySelector('a[href="#"]');
        
        // Récupérer la div à afficher
        const contentDiffQuotaActuel = document.getElementById('contentDiffQuotaActuel');

        // Ajouter un événement de clic sur le lien "En savoir plus"
        enSavoirPlus.addEventListener('click', function(event) {
            event.preventDefault(); // Empêche le lien de rediriger

            // Si la div est cachée, l'afficher, sinon la cacher
            if (contentDiffQuotaActuel.classList.contains('d-none')) {
                contentDiffQuotaActuel.classList.remove('d-none'); // Retirer la classe d-none pour afficher
                enSavoirPlus.textContent = "Fermer"; // Modifier le texte du lien en "Cacher"
            } else {
                contentDiffQuotaActuel.classList.add('d-none'); // Ajouter la classe d-none pour cacher
                enSavoirPlus.textContent = "En savoir plus"; // Remettre le texte du lien à "En savoir plus"
            }
        });
    });
</script>

